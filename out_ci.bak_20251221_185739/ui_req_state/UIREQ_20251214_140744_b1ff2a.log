[VSP_CI_OUTER] REPO_ROOT  = /home/test/Data/SECURITY-10-10-v4
[VSP_CI_OUTER] SCRIPT_DIR = /home/test/Data/SECURITY-10-10-v4/ci/VSP_CI_OUTER
[VSP_CI_OUTER] BUNDLE_ROOT= /home/test/Data
[VSP_CI_OUTER] SRC_ROOT   = /home/test/Data/SECURITY-10-10-v4
[VSP_CI_OUTER_RUNNERLOG_V1] runner_log=/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/runner.log
[VSP_CI_OUTER] RUN_ID     = VSP_CI_20251214_140745
[VSP_CI_OUTER] RUN_DIR    = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745
[VSP_CI_OUTER] === VSP CI OUTER BẮT ĐẦU ===
[VSP_CI_OUTER] Gọi gate core: /home/test/Data/SECURITY-10-10-v4/ci/VSP_CI_OUTER/vsp_ci_gate_core_v1.sh
[VSP_CI_GATE] BUNDLE_ROOT = /home/test/Data
[VSP_CI_GATE] SRC_ROOT    = /home/test/Data/SECURITY-10-10-v4
[VSP_CI_GATE] RUN_DIR     = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745
[VSP_CI_GATE] RUN_ID      = VSP_CI_20251214_140745
[VSP_CI_GATE_AUTOPICK_RUNNER_V1] RUNNER=/home/test/Data/SECURITY_BUNDLE/bin/run_all_tools_v2.sh
[VSP_CI_GATE] RUNNER      = /home/test/Data/SECURITY_BUNDLE/bin/run_all_tools_v2.sh
[VSP_CI_GATE] === CHẠY RUNNER VSP (FULL SCAN) ===
[VSP_CI_GATE] Cmd: /home/test/Data/SECURITY_BUNDLE/bin/run_all_tools_v2.sh "/home/test/Data/SECURITY-10-10-v4" "/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745"
===== [BOOT] runner.log=/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/runner.log ts=2025-12-14T14:07:45+07:00 =====
==============================================
[VSP] RUN ALL TOOLS V2 – PROFILE=FULL_EXT LEVEL=FULL_EXT
ROOT     = /home/test/Data/SECURITY_BUNDLE
SRC      = /home/test/Data/SECURITY-10-10-v4
OUT_DIR  = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745
NO_NET   = 0
==============================================

===== [3/8] KICS (EXT) =====
===== [KICS_V3] 2025-12-14T14:07:45+07:00 =====
[KICS_V3] ROOT=/home/test/Data/SECURITY_BUNDLE
[KICS_V3] SRC=/home/test/Data/SECURITY-10-10-v4
[KICS_V3] OUT_DIR=/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745
[KICS_V3] OUT_KICS=/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/kics
[KICS_V3] TIMEOUT=1800s KILL=30s
[KICS_V3] EXCL_MODE=list
[KICS_V3] CMD: kics scan -p /home/test/Data/SECURITY-10-10-v4 -o /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/kics --report-formats json --no-color --exclude-paths /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745,/home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/kics,/home/test/Data/SECURITY-10-10-v4/.git,/home/test/Data/SECURITY-10-10-v4/node_modules,/home/test/Data/SECURITY-10-10-v4/out_ci,/home/test/Data/SECURITY-10-10-v4/dist,/home/test/Data/SECURITY-10-10-v4/build,/home/test/Data/SECURITY-10-10-v4/target,/home/test/Data/SECURITY-10-10-v4/venv,/home/test/Data/SECURITY-10-10-v4/.venv,/home/test/Data/SECURITY-10-10-v4/__pycache__,/home/test/Data/SECURITY-10-10-v4/.cache,/home/test/Data/SECURITY-10-10-v4/.idea,/home/test/Data/SECURITY-10-10-v4/.vscode
timeout: gặp lỗi khi chạy câu lệnh “kics”: Không có tập tin hoặc thư mục như vậy
[KICS_V3][DEGRADED] reason=missing rc=127 (kics not found)
bin/run_kics_v3.sh: dòng 77: import json, os, time
out_dir = ${OUT_DIR!r}
path = os.path.join(out_dir, "degraded_tools.json")
tool = {
  "tool": "kics",
  "reason": ${reason!r},
  "exit_code": int(${rc}),
  "timeout_sec": int(${TIMEOUT}),
  "kill_sec": int(${KILL_SEC}),
  "log_rel": "kics/kics.log",
  "ts": time.strftime("%Y-%m-%dT%H:%M:%S%z")
}

data = None
if os.path.exists(path):
  try:
    with open(path, "r", encoding="utf-8") as f:
      data = json.load(f)
  except Exception:
    data = None

# Support both schemas: list OR {"tools":{...}} OR {"items":[...]}
if isinstance(data, list):
  data.append(tool)
elif isinstance(data, dict):
  if isinstance(data.get("items"), list):
    data["items"].append(tool)
  elif isinstance(data.get("tools"), dict):
    data["tools"]["kics"] = tool
  else:
    # default: make items list
    data.setdefault("items", [])
    if isinstance(data["items"], list):
      data["items"].append(tool)
else:
  data = {"items": [tool]}

tmp = path + ".tmp"
with open(tmp, "w", encoding="utf-8") as f:
  json.dump(data, f, ensure_ascii=False, indent=2)
os.replace(tmp, path)
print("[KICS_V3] degraded_tools.json updated:", path)
: thay thế sai
[KICS] rc=0

===== [1/8] Gitleaks (EXT) =====
[Gitleaks] ROOT    = /home/test/Data/SECURITY_BUNDLE
[Gitleaks] OUT_DIR = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745
[Gitleaks] SRC     = /home/test/Data/SECURITY-10-10-v4
[Gitleaks] PROFILE = ext
[Gitleaks] MODE    = BUILTIN_RULES
[Gitleaks] JSON    = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/gitleaks/gitleaks.json
[Gitleaks] LOG     = /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/gitleaks/gitleaks.log
Đã kết thúc
[Gitleaks][WARN] gitleaks detect kết thúc với rc=143, xem log: /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/gitleaks/gitleaks.log
[Gitleaks] Findings (coi như hợp lệ để unify): 0 (tool_rc=143)
[WARN] [1/8] Gitleaks (EXT) rc=143 – vẫn tiếp tục pipeline.
/home/test/Data/SECURITY_BUNDLE/bin/run_all_tools_v2.sh: dòng 486: có lỗi cú pháp ở gần thẻ bài bất thường “)”
[VSP_CI_GATE] Runner kết thúc với RC=2
[VSP_CI_GATE] [VSP_CI_GATE] Runner RC normalize: raw=0 -> rc=0 degraded=0
[VSP_CI_GATE] Không thấy /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/report/summary_unified.json, thử gọi engine unify BE để build báo cáo thương mại...
[VSP_CI_GATE] WARN: Không tìm thấy script unify: /home/test/Data/bin/vsp_unify_from_run_dir_v1.sh
[VSP_CI_GATE]       (Set ENV VSP_UNIFY_SCRIPT để trỏ đúng engine unify BE đang dùng).
[VSP_CI_GATE] WARN: Không tìm thấy /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/report/summary_unified.json – bỏ qua phần gate theo severity.
[VSP_CI_GATE]       Kiểm tra lại unify trong runner hoặc script unify BE.
[VSP_CI_OUTER] Gate core kết thúc với mã trả về: 2
[VSP_CI_SUMMARY] ERROR: Không tìm thấy /home/test/Data/SECURITY-10-10-v4/out_ci/VSP_CI_20251214_140745/report/summary_unified.json
[VSP_CI_OUTER] === VSP CI OUTER: THẤT BẠI (RC=1) ===
