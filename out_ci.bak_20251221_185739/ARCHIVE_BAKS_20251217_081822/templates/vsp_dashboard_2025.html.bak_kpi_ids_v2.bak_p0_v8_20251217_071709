<div id="vsp-dashboard-main"
     style="padding:24px 32px 32px 32px; color:#E5E7EB; font-family:system-ui, -apple-system, BlinkMacSystemFont, 'Inter', sans-serif;">

  <!-- Header nhỏ mô tả -->
  <div style="margin-bottom:16px;">
    <div style="font-size:13px; opacity:0.7;">
      CIO-level view · auto refresh from <code>/api/vsp/dashboard_v3</code>
    </div>
  </div>

  <!-- KPI ZONE -->
  <div style="margin-bottom:24px;">
    <div style="font-size:12px; text-transform:uppercase; letter-spacing:0.08em; opacity:0.7; margin-bottom:4px;">
      KPI Zone
    </div>
    <div style="font-size:12px; opacity:0.7; margin-bottom:12px;">
      6 severity bucket + 4 advanced KPI
    </div>

    <!-- Hàng 1: Total + Score + 3 KPI nâng cao -->
    <div style="display:flex; flex-wrap:wrap; gap:12px; margin-bottom:12px;">

      <!-- Total findings -->
      <div style="flex:0 0 160px; padding:12px 16px; border-radius:10px;
                  background:linear-gradient(135deg, rgba(30,64,175,0.4), rgba(15,23,42,0.9));
                  border:1px solid rgba(148,163,184,0.25);">
        <div style="font-size:11px; opacity:0.7; text-transform:uppercase;">Total Findings</div>
        <div id="vsp-kpi-total"
             style="font-size:24px; font-weight:600; margin-top:4px;">--</div>
      </div>

      <!-- Security Score -->
      <div style="flex:0 0 160px; padding:12px 16px; border-radius:10px;
                  background:linear-gradient(135deg, rgba(8,47,73,0.7), rgba(15,23,42,0.9));
                  border:1px solid rgba(148,163,184,0.25);">
        <div style="font-size:11px; opacity:0.7; text-transform:uppercase;">Security Score</div>
        <div id="vsp-kpi-security-score"
             style="font-size:24px; font-weight:600; margin-top:4px;">--</div>
        <div style="font-size:10px; opacity:0.6;">0–100 (higher is better)</div>
      </div>

      <!-- Top risky tool -->
      <div style="flex:1 1 200px; padding:12px 16px; border-radius:10px;
                  background:radial-gradient(circle at top left, rgba(251,191,36,0.35), rgba(15,23,42,0.95));
                  border:1px solid rgba(148,163,184,0.25); min-width:220px;">
        <div style="font-size:11px; opacity:0.7; text-transform:uppercase;">Top Risky Tool</div>
        <div id="vsp-kpi-top-tool"
             style="font-size:16px; font-weight:500; margin-top:4px;">--</div>
        <div style="font-size:11px; opacity:0.6;">Most Critical/High findings</div>
      </div>

      <!-- Top CWE -->
      <div style="flex:1 1 200px; padding:12px 16px; border-radius:10px;
                  background:radial-gradient(circle at top left, rgba(94,234,212,0.25), rgba(15,23,42,0.95));
                  border:1px solid rgba(148,163,184,0.25); min-width:220px;">
        <div style="font-size:11px; opacity:0.7; text-transform:uppercase;">Top Impacted CWE</div>
        <div id="vsp-kpi-top-cwe"
             style="font-size:16px; font-weight:500; margin-top:4px;">--</div>
        <div style="font-size:11px; opacity:0.6;">Most frequent weakness</div>
      </div>

      <!-- Top vulnerable module -->
      <div style="flex:1 1 260px; padding:12px 16px; border-radius:10px;
                  background:radial-gradient(circle at top left, rgba(129,140,248,0.25), rgba(15,23,42,0.95));
                  border:1px solid rgba(148,163,184,0.25); min-width:260px;">
        <div style="font-size:11px; opacity:0.7; text-transform:uppercase;">Top Vulnerable Module</div>
        <div id="vsp-kpi-top-module"
             style="font-size:13px; font-weight:500; margin-top:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;">
          --
        </div>
        <div style="font-size:11px; opacity:0.6;">Library / path with heaviest risk</div>
      </div>
    </div>

    <!-- Hàng 2: 6 severity bucket -->
    <div style="display:flex; flex-wrap:wrap; gap:10px;">
      <!-- mỗi card 1 severity -->
      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(30,64,175,0.35); border:1px solid rgba(248,113,113,0.6);">
        <div style="font-size:11px; opacity:0.8;">CRITICAL</div>
        <div id="vsp-kpi-critical"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>

      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(180,83,9,0.3); border:1px solid rgba(251,191,36,0.7);">
        <div style="font-size:11px; opacity:0.8;">HIGH</div>
        <div id="vsp-kpi-high"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>

      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(22,101,52,0.3); border:1px solid rgba(74,222,128,0.6);">
        <div style="font-size:11px; opacity:0.8;">MEDIUM</div>
        <div id="vsp-kpi-medium"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>

      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(15,118,110,0.3); border:1px solid rgba(45,212,191,0.6);">
        <div style="font-size:11px; opacity:0.8;">LOW</div>
        <div id="vsp-kpi-low"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>

      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(30,64,175,0.25); border:1px solid rgba(96,165,250,0.7);">
        <div style="font-size:11px; opacity:0.8;">INFO</div>
        <div id="vsp-kpi-info"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>

      <div style="flex:1 1 120px; padding:10px 12px; border-radius:10px;
                  background:rgba(76,29,149,0.35); border:1px solid rgba(192,132,252,0.7);">
        <div style="font-size:11px; opacity:0.8;">TRACE</div>
        <div id="vsp-kpi-trace"
             style="font-size:18px; font-weight:600; margin-top:2px;">--</div>
      </div>
    </div>
  </div>

  <!-- CHART ZONE -->
  <div>
    <div style="font-size:12px; text-transform:uppercase; letter-spacing:0.08em; opacity:0.7; margin-bottom:4px;">
      Charts
    </div>
    <div style="font-size:12px; opacity:0.7; margin-bottom:12px;">
      Severity, trend, tool risk, top CWE / module
    </div>

    <!-- Row 1: severity + trend -->
    <div style="display:flex; flex-wrap:wrap; gap:16px; margin-bottom:16px;">
      <div style="flex:1 1 360px; min-height:220px; border-radius:14px;
                  background:rgba(15,23,42,0.9); border:1px solid rgba(30,64,175,0.6); padding:16px;">
        <div style="font-size:12px; opacity:0.75; margin-bottom:8px;">Severity Distribution</div>
        <div id="vsp-chart-severity"
             style="width:100%; height:170px;"></div>
      </div>

      <div style="flex:1 1 360px; min-height:220px; border-radius:14px;
                  background:rgba(15,23,42,0.9); border:1px solid rgba(30,64,175,0.35); padding:16px;">
        <div style="font-size:12px; opacity:0.75; margin-bottom:8px;">Findings Trend</div>
        <div style="font-size:11px; opacity:0.6; margin-bottom:4px;">Total findings per scan (latest runs)</div>
        <div id="vsp-chart-trend"
             style="width:100%; height:170px;"></div>
      </div>
    </div>

    <!-- Row 2: by tool + top CWE -->
    <div style="display:flex; flex-wrap:wrap; gap:16px;">
      <div style="flex:1 1 360px; min-height:220px; border-radius:14px;
                  background:rgba(15,23,42,0.9); border:1px solid rgba(30,64,175,0.35); padding:16px;">
        <div style="font-size:12px; opacity:0.75; margin-bottom:8px;">Critical / High by Tool</div>
        <div style="font-size:11px; opacity:0.6; margin-bottom:4px;">
          Top security tools (Semgrep, CodeQL, Gitleaks, ...)
        </div>
        <div id="vsp-chart-bytool"
             style="width:100%; height:170px;"></div>
      </div>

      <div style="flex:1 1 360px; min-height:220px; border-radius:14px;
                  background:rgba(15,23,42,0.9); border:1px solid rgba(30,64,175,0.35); padding:16px;">
        <div style="font-size:12px; opacity:0.75; margin-bottom:8px;">Top CWE Exposure</div>
        <div style="font-size:11px; opacity:0.6; margin-bottom:4px;">
          Top weaknesses by total findings
        </div>
        <div id="vsp-chart-topcwe"
             style="width:100%; height:170px;"></div>
      </div>
    </div>
  </div>
</div>

<script src="/static/js/vsp_tabs_hash_router_v1.js" defer></script>

<script src="/static/js/vsp_dashboard_enhance_v1.js?v=20251217_070656" defer></script>
