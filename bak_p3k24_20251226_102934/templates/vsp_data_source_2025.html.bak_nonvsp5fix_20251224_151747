<!doctype html><html lang="vi"><head>
<script>window.__VSP_ASSET_V="{{ asset_v }}";</script>
<!-- ===================== VSP_P2_6C_DASH_FETCH_SHIM_PRELOAD_V1 ===================== -->
<script>
(function(){
  if(window.__VSP_FETCH_SHIM_PRELOAD_V1) return;
  window.__VSP_FETCH_SHIM_PRELOAD_V1 = true;

  // Root fallback helper (used by some dash scripts)
  window.__VSP_DASH_ROOT = function(){
    return document.querySelector('#vsp-dashboard-main')
        || document.querySelector('#vsp_dashboard_main')
        || document.querySelector('#vsp-dashboard')
        || document.body;
  };

  const _fetch = window.fetch ? window.fetch.bind(window) : null;
  if(!_fetch) return;

  window.fetch = async function(input, init){
    try{
      if(init && typeof init === 'object'){
        const m = String(init.method || '').toUpperCase();
        if(m === 'HEAD'){
          init = Object.assign({}, init, {method:'GET'});
        }
      }
    }catch(e){}

    const res = await _fetch(input, init);

    try{
      const url = (typeof input === 'string') ? input : (input && input.url) || '';
      // unwrap wrapper payload for findings_unified.json
      if(url.includes('/api/vsp/run_file_allow') && url.includes('path=findings_unified.json')){
        const clone = res.clone();
        const j = await clone.json().catch(()=>null);
        if(j && j.ok === true && Array.isArray(j.findings)){
          const body = JSON.stringify({ meta: j.meta || {}, findings: j.findings || [] });
          return new Response(body, { status: res.status, headers: res.headers });
        }
      }
    }catch(e){}

    return res;
  };
})();
</script>
<!-- ===================== /VSP_P2_6C_DASH_FETCH_SHIM_PRELOAD_V1 ===================== -->

<meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VSP â€¢ Data Source</title>
<link rel="stylesheet" href="/static/css/vsp_dark_commercial_p1_2.css"/>
<style>html,body{background:#070e1a;color:#e5e7eb;margin:0;}</style>
</head><body>
<!-- VSP_P2_COMM_ANCHOR_ASSETV_V1 -->
<div id="vsp-dashboard-main"></div>
<!-- VSP_P1_REAL_SHELL_REQUIRED_MARKERS_V1 -->
<div id="vsp-kpi-testids" style="display:none">
  <span data-testid="kpi_total"></span>
  <span data-testid="kpi_critical"></span>
  <span data-testid="kpi_high"></span>
  <span data-testid="kpi_medium"></span>
  <span data-testid="kpi_low"></span>
  <span data-testid="kpi_info_trace"></span>
</div>
<div id="vsp-runs-main" style="display:none"></div>
<div id="vsp-data-source-main" style="display:none"></div>
<div id="vsp-settings-main" style="display:none"></div>
<div id="vsp-rule-overrides-main" style="display:none"></div>
<!-- end VSP_P1_REAL_SHELL_REQUIRED_MARKERS_V1 -->


<div id="vsp_tab_root" data-vsp-tab="data_source" style="padding:16px"><div style="color:#94a3b8;font-size:12px">Loading...</div></div>
<script src="/static/js/vsp_tabs3_common_v3.js?v={{ asset_v }}"></script>
<script src="/static/js/vsp_data_source_tab_v3.js?v={{ asset_v }}"></script>

<!-- VSP_P1_DATA_SOURCE_PAGINATION_V1 -->
<script src="/static/js/vsp_data_source_pagination_v1.js?v={{ asset_v }}"></script>

{% if request.path == "/vsp5" %}
<script src="/static/js/vsp_dashboard_luxe_v1.js?v={{ asset_v }}"></script>
{% endif %}

<div id=\"vsp_ds_root\"></div>

<script src=/static/js/vsp_data_source_lazy_v1.js"></script></body></html>

<!-- VSP_P0_DATA_SOURCE_LAZY_UI_V1 -->

<!-- VSP_P2_TEMPLATE_ASSET_V_CONSISTENT_V1 -->
